<!DOCTYPE html>
<html>
<meta charset="utf-8">
<style>
body {
  font: 14px sans-serif;
}

.output-container {
  margin-top: 2em;
}
</style>

<span id="svg-styles" style="display:none">
text {
  font: 14px sans-serif;
}

.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

.line {
  fill: none;
  stroke-width: 1.5px;
}

.data-series-0 {
  stroke: steelblue;
  fill: steelblue;
}

.data-series-1 {
  stroke: crimson;
  fill: crimson;
}

.data-series-2 {
  stroke: mediumseagreen;
  fill: mediumseagreen;
}

.data-series-3 {
  stroke: mediumslateblue;
  fill: mediumslateblue;
}

.data-series-4 {
  stroke: goldenrod;
  fill: goldenrod;
}

.error-bar {
  fill: none;
}
</span>

<body>
<h1>purescript-benchotron SVG renderer</h1>

<h2>How to use this</h2>
<p><strong>Step 1.</strong> Perform benchmarks on your PureScript / JavaScript
code, using
<a href="https://github.com/hdgarrood/purescript-benchotron">purescript-benchotron</a>.
</p>
<p><strong>Step 2.</strong> Upload the results here and have lovely SVG graphs
rendered for you.</p>


<p>Error bars represent 95% confidence intervals.</p>

<div>
<form>
<input type="file" id="file"></input>
<button type="button" id="export">Export to SVG</button>
</form>
</div>

<div class='output-container'>
<output id="graph">
</output>
</div>

<script src="d3.v3.min.js"></script>
<script src="FileSaver.min.js"></script>
<script src="benchotronRenderer.js"></script>

<script>
function handleFileSelect(evt) {
  var files = evt.target.files

  if (files.length > 0) {
    var file = files[0]

    var reader = new FileReader
    reader.onload = function(e) {
      var jsonString = e.target.result
      var data = JSON.parse(jsonString)
      BenchotronRenderer.drawGraph(data, '#graph')
    }
    reader.readAsText(file)
  }
}

document.getElementById('file')
  .addEventListener('change', handleFileSelect, false)

function handleSvgExport() {
  var el = document.getElementsByTagName("svg")[0]
  if (el != null) {
    var svgString = (new XMLSerializer).serializeToString(el)
    var svgBlob = new Blob([svgString], {type: 'text/svg'})
    saveAs(svgBlob, "graph.svg")
  }
}

document.getElementById('export')
  .addEventListener('click', handleSvgExport, false)
</script>

</html>
